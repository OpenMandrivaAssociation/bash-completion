diff -Naur -x '*~' -x '*.orig' -x '*.rej' bash-completion-20100203/completions/rpm bash-completion-20100203-rpm-database/completions/rpm
--- bash-completion-20100203/completions/rpm	2010-02-02 19:02:26.000000000 +0100
+++ bash-completion-20100203-rpm-database/completions/rpm	2010-02-03 23:05:49.000000000 +0100
@@ -17,8 +17,10 @@
         # SUSE's rpmqpack is faster than rpm -qa
         COMPREPLY=( $( compgen -W '$( rpmqpack )' -- "$cur" ) )
     else
-        _rpm_nodigsig
-        COMPREPLY=( $( rpm -qa $nodig $nosig --qf='%{NAME} ' "$cur*" ) )
+        if [ -n "${COMP_RPM_DATABASE:-}" ]; then
+            _rpm_nodigsig
+            COMPREPLY=( $( rpm -qa $nodig $nosig --qf='%{NAME} ' "$cur*" ) )
+        fi
     fi
 }
 
